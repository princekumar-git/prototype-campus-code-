<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CampusCode - Unified Contests</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ["Poppins", "sans-serif"] },
                    colors: {
                        primary: { 50: "#E7F0FA", 100: "#D0E1F5", 200: "#7BA4D0", 300: "#4D84C0", 400: "#2E5E99", 500: "#1E4A7A", 600: "#0D2440" },
                        dark: { bg: "#111827", card: "#1F2937", text: "#F9FAFB", border: "#374151" }
                    },
                },
            },
        };
    </script>
    <style>
        /* --- Scrollbar --- */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        .dark ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #7ba4d0; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #2e5e99; }

        /* --- Sidebar Logic --- */
        .sidebar { transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden; }
        .sidebar.collapsed { width: 5rem; }
        .sidebar.collapsed .nav-item { justify-content: center; padding-left: 0; padding-right: 0; }
        .sidebar.collapsed .nav-item i { margin-right: 0; font-size: 1.25rem; }
        .sidebar.collapsed .nav-item span { display: none; }
        .sidebar.collapsed .logo-text { display: none; }
        .sidebar.collapsed .bottom-menu span { display: none; }
        .sidebar.collapsed .bottom-menu .nav-item { justify-content: center; }

        /* --- Nav Item Styling --- */
        .nav-item { transition: all 0.2s ease; position: relative; display: flex; align-items: center; padding: 0.75rem 1rem; margin-bottom: 0.25rem; color: #374151; border-radius: 0.5rem; cursor: pointer; white-space: nowrap; }
        .nav-item:hover { background-color: #f3f4f6; }
        .dark .nav-item { color: #d1d5db; }
        .dark .nav-item:hover { background-color: #374151; }
        .nav-item.active { background-color: #d0e1f5; color: #1e4a7a; }
        .dark .nav-item.active { background-color: #1e4a7a; color: #ffffff; }
        .nav-item.active::before { content: ""; position: absolute; left: 0; top: 50%; transform: translateY(-50%); height: 60%; width: 4px; background-color: #2e5e99; border-radius: 0 4px 4px 0; }
        .dark .nav-item.active::before { background-color: #60a5fa; }
        .nav-item i { width: 1.5rem; text-align: center; margin-right: 0.75rem; font-size: 1.1rem; flex-shrink: 0; }
        .nav-item span { font-size: 0.875rem; font-weight: 500; }

        /* --- Other Styles --- */
        .tab-btn { border-bottom: 2px solid transparent; transition: all 0.3s; }
        .tab-btn.active { border-bottom: 2px solid #1e4a7a; color: #1e4a7a; font-weight: 600; }
        .dark .tab-btn.active { border-bottom: 2px solid #7BA4D0; color: #7BA4D0; }
        #shareToast { transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); transform: translateX(-50%) translateY(100px); opacity: 0; }
        #shareToast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .college-scroll::-webkit-scrollbar { width: 5px; }
        .college-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .detail-section { position: relative; padding-left: 1.5rem; border-left: 4px solid #1e4a7a; margin-bottom: 2rem; }
        .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    </style>
</head>

<body class="bg-gray-50 dark:bg-gray-900 min-h-screen font-sans transition-colors duration-200">
    
    <div id="shareToast" class="fixed bottom-10 left-1/2 -translate-x-1/2 z-[300] bg-primary-500 text-white px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-3">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Success!</span>
    </div>

    <div id="shareMenu" class="hidden fixed z-[250] bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 rounded-2xl p-2 w-48 shadow-xl">
        <button onclick="shareTo('WhatsApp')" class="w-full flex items-center gap-3 p-3 rounded-xl hover:bg-green-50 dark:hover:bg-green-900/20 text-gray-700 dark:text-gray-200 transition-colors">
            <i class="fab fa-whatsapp text-green-500"></i><span class="text-sm font-semibold">WhatsApp</span>
        </button>
        <button onclick="shareTo('Copy')" class="w-full flex items-center gap-3 p-3 rounded-xl hover:bg-primary-50 dark:hover:bg-primary-900/20 text-gray-700 dark:text-gray-200 transition-colors">
            <i class="fas fa-link text-primary-400"></i><span class="text-sm font-semibold">Copy Link</span>
        </button>
    </div>

    <div class="flex h-screen overflow-hidden">
        
        <aside id="mainSidebar" class="sidebar w-64 bg-white dark:bg-gray-800 shadow-sm border-r border-gray-200 dark:border-gray-700 flex flex-col h-screen flex-shrink-0 transition-colors duration-200 z-50">
            <div class="p-6 flex-shrink-0 flex items-center justify-between h-[88px]">
                <h1 class="text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2 overflow-hidden whitespace-nowrap">
                    <i class="fas fa-code text-primary-500 text-2xl flex-shrink-0"></i>
                    <span class="logo-text transition-all duration-300 opacity-100 w-auto">CampusCode</span>
                </h1>
                <button id="sidebarToggleBtn" class="p-1.5 rounded-lg text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-500 transition-colors focus:outline-none">
                    <i class="fas fa-chevron-left transition-transform duration-300"></i>
                </button>
            </div>

            <nav class="flex-1 px-4 space-y-1 overflow-y-auto mt-2">
                <a href="dashboard.html" class="nav-item"><i class="fas fa-home"></i><span>Home</span></a>
                <a href="program.html" class="nav-item"><i class="fa-solid fa-layer-group"></i><span>Programs</span></a>
                <a href="contest.html" class="nav-item active"><i class="fas fa-trophy"></i><span>Contests</span></a>
                <a href="manage_user.html" class="nav-item"><i class="fa-solid fa-users"></i><span>Users</span></a>
                <a href="update-report.html" class="nav-item"><i class="fas fa-file-invoice"></i><span>Reports</span></a>
                <a href="profile.html" class="nav-item"><i class="fas fa-user"></i><span>Profile</span></a>
            </nav>

            <div class="p-4 space-y-1 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex-shrink-0 bottom-menu">
                <a href="help_support.html" class="nav-item"><i class="far fa-question-circle"></i><span>Help & Support</span></a>
                <div id="settingsTrigger" class="nav-item"><i class="fas fa-cog"></i><span>Settings</span></div>
            </div>
        </aside>

        <div class="flex-1 overflow-y-auto">
            
            <header class="bg-white dark:bg-gray-800 shadow-sm transition-colors duration-200 sticky top-0 z-40">
                <div class="px-8 py-3 flex justify-between items-center">
                    
                    <div class="flex-1 max-w-2xl flex items-center gap-4">
                        <div class="relative flex items-center w-full">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-search text-gray-400"></i>
                            </div>
                            <input type="text"
                                class="block w-full pl-10 pr-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm text-gray-900 dark:text-gray-100 placeholder-gray-500 focus:ring-2 focus:ring-primary-400 focus:border-transparent transition-all"
                                placeholder="Search contests..." />
                        </div>
                    </div>

                    <div class="ml-4 flex items-center gap-3 relative">
                        <button id="themeToggleBtn" class="p-2 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none transition-transform active:scale-95">
                            <i class="fas fa-moon text-xl"></i>
                        </button>
                        
                        <div class="relative">
                            <button id="notificationBtn" class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 focus:outline-none">
                                <i class="fas fa-bell text-xl"></i>
                                <span class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500 border-2 border-white dark:border-gray-800"></span>
                            </button>
                            <div id="notifDropdown" class="hidden absolute right-0 mt-3 w-80 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-100 dark:border-gray-700 z-50">
                                <div class="p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center">
                                    <h3 class="font-semibold text-gray-800 dark:text-white text-sm">Notifications</h3>
                                    <button class="text-xs text-primary-500 font-medium hover:text-primary-600">Mark all read</button>
                                </div>
                                <div class="max-h-64 overflow-y-auto">
                                    <div class="p-3 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700 cursor-pointer">
                                        <p class="text-xs font-semibold text-primary-500">New Registration</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-300 mt-1">Student registered in CSE Dept.</p>
                                    </div>
                                    <div class="p-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer">
                                        <p class="text-xs font-semibold text-yellow-500">Contest Alert</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-300 mt-1">New college-level contest created.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button onclick="toggleProfile()" class="ml-2 flex items-center gap-3 p-1 pr-3 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                             <div class="h-9 w-9 rounded-full bg-primary-500 flex items-center justify-center text-white font-bold text-sm">RK</div>
                             <span class="text-sm font-medium text-gray-700 dark:text-gray-200 hidden sm:block">Raj Kumar</span>
                        </button>
                    </div>
                </div>
            </header>

            <main class="p-8">
                <div class="flex items-center gap-4 mb-8 bg-gray-200 dark:bg-gray-800 p-1.5 rounded-2xl w-fit">
                    <button id="collegeLevelBtn" onclick="switchLevel('college')" class="px-6 py-2.5 rounded-xl font-bold transition-all bg-white dark:bg-gray-700 shadow-sm text-primary-500">College Level</button>
                    <button id="globalLevelBtn" onclick="switchLevel('global')" class="px-6 py-2.5 rounded-xl font-bold transition-all text-gray-500 dark:text-gray-400">Global Level</button>
                </div>

                <div class="flex justify-between items-center mb-6">
                    <h2 id="pageHeading" class="text-3xl font-bold text-gray-800 dark:text-white">College Contests</h2>
                    <button id="createContestBtn" onclick="openCreateModal()" class="bg-[#0D1B2A] text-white px-6 py-2 rounded-lg font-semibold flex items-center gap-2 hover:bg-black transition-all">
                        <i class="fas fa-plus"></i> Create Contest
                    </button>
                </div>

                <div class="flex gap-8 border-b border-gray-200 dark:border-gray-700 mb-6">
                    <button id="upcomingTab" onclick="switchTab('upcoming')" class="tab-btn pb-3 active">Upcoming Events</button>
                    <button id="pastTab" onclick="switchTab('past')" class="tab-btn pb-3 text-gray-400">Past Results</button>
                </div>

                <div id="contestContainer" class="space-y-6"></div>
            </main>
        </div>
    </div>

    <div id="createModal" class="fixed inset-0 z-[110] hidden flex items-center justify-center bg-black/50 backdrop-blur-sm p-4">
        <div class="bg-white dark:bg-gray-800 w-full max-w-xl rounded-3xl p-8 shadow-2xl max-h-[90vh] overflow-y-auto no-scrollbar">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold dark:text-white">Configure Contest</h3>
                <button id="deleteBtn" onclick="deleteContest()" class="hidden text-red-500 hover:text-red-700"><i class="fas fa-trash"></i></button>
            </div>
            
            <div class="space-y-5">
                <input type="hidden" id="editId">
                
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase">Scope</label>
                    <div class="flex gap-4 mt-1">
                        <label class="flex-1 cursor-pointer"><input type="radio" name="scope" value="internal" checked onchange="toggleOpponentSelect()" class="hidden peer"><div class="p-3 text-center rounded-xl border-2 dark:border-gray-700 peer-checked:border-primary-500 peer-checked:bg-primary-50 dark:peer-checked:bg-primary-900/20 transition-all font-bold text-sm">Internal</div></label>
                        <label class="flex-1 cursor-pointer"><input type="radio" name="scope" value="inter" onchange="toggleOpponentSelect()" class="hidden peer"><div class="p-3 text-center rounded-xl border-2 dark:border-gray-700 peer-checked:border-purple-500 peer-checked:bg-purple-50 dark:peer-checked:bg-purple-900/20 transition-all font-bold text-sm">Multi-College</div></label>
                    </div>
                </div>

                <div id="opponentSection" class="hidden p-5 bg-gray-50 dark:bg-gray-900/50 rounded-2xl border dark:border-gray-700 space-y-3">
                    <div class="flex items-center justify-between">
                        <label class="text-[10px] font-bold text-gray-400 uppercase">Competitors</label>
                        <button type="button" onclick="toggleSelectAll()" id="selectAllBtn" class="text-[10px] font-bold text-purple-600 uppercase">Select All</button>
                    </div>
                    <div class="relative">
                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs"></i>
                        <input type="text" id="collegeSearch" onkeyup="filterColleges()" placeholder="Search colleges..." class="w-full pl-9 pr-4 py-2 text-xs rounded-lg border dark:bg-gray-800 outline-none">
                    </div>
                    <div class="grid grid-cols-1 gap-1 max-h-32 overflow-y-auto pr-2 college-scroll" id="collegeCheckboxList"></div>
                    <div class="flex gap-2 pt-2 border-t dark:border-gray-700">
                        <input type="text" id="customCollegeInput" placeholder="Add college..." class="flex-1 p-2 text-sm rounded-lg border dark:bg-gray-700 outline-none">
                        <button type="button" onclick="addNewCollege()" class="bg-purple-500 text-white px-4 py-2 rounded-lg text-sm font-bold">Add</button>
                    </div>
                </div>

                <input type="text" id="newTitle" placeholder="Contest Title" class="w-full p-3 rounded-xl border dark:bg-gray-700 dark:text-white outline-none">
                
                <div class="grid grid-cols-2 gap-4">
                    <div><label class="text-[10px] font-bold text-gray-400 uppercase">Event Date</label><input type="date" id="contestDate" class="w-full p-3 rounded-xl border dark:bg-gray-700 dark:text-white outline-none"></div>
                    <div><label class="text-[10px] font-bold text-gray-400 uppercase">Reg. Deadline</label><input type="date" id="contestDeadline" class="w-full p-3 rounded-xl border dark:bg-gray-700 dark:text-white outline-none"></div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <input type="text" id="contestTime" placeholder="Duration (e.g. 3h)" class="p-3 rounded-xl border dark:bg-gray-700 dark:text-white outline-none">
                    <input type="text" id="contestEligibility" placeholder="Eligibility (e.g. 3rd Year)" class="p-3 rounded-xl border dark:bg-gray-700 dark:text-white outline-none">
                </div>

                <textarea id="contestDesc" rows="3" placeholder="Description & Prizes..." class="w-full p-3 rounded-xl border dark:bg-gray-700 dark:text-white outline-none"></textarea>

                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase ml-1">Rules/Guidelines (PDF)</label>
                    <label class="mt-1 flex flex-col items-center justify-center w-full h-20 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl cursor-pointer bg-gray-50 dark:bg-gray-900/50">
                        <div class="flex flex-col items-center justify-center">
                            <i class="fas fa-file-pdf text-xl text-gray-400 mb-1"></i>
                            <p id="fileName" class="text-[10px] text-gray-500">Click to upload PDF</p>
                        </div>
                        <input type="file" id="contestFile" accept=".pdf" class="hidden" onchange="document.getElementById('fileName').innerText = this.files[0].name" />
                    </label>
                </div>

                <div class="flex gap-4 pt-4">
                    <button onclick="saveContest()" class="flex-1 bg-primary-500 text-white py-4 rounded-xl font-bold">Save Contest</button>
                    <button onclick="closeCreateModal()" class="flex-1 bg-gray-100 dark:bg-gray-700 dark:text-white py-4 rounded-xl font-bold">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div id="detailsModal" class="fixed inset-0 z-[200] hidden flex items-center justify-center bg-black/60 backdrop-blur-md p-4">
        <div class="bg-white dark:bg-gray-800 w-full max-w-2xl rounded-[2.5rem] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300">
            <div class="p-6 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900/30">
                <h3 class="text-xl font-bold dark:text-white">Contest Details</h3>
                <button onclick="closeDetailsModal()" class="h-10 w-10 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center"><i class="fas fa-times text-gray-500"></i></button>
            </div>
            <div class="p-8 max-h-[70vh] overflow-y-auto no-scrollbar space-y-8">
                <div id="countdownBox" class="bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-900/30 rounded-2xl p-4 flex items-center justify-between">
                    <div>
                        <p class="text-[10px] font-bold text-red-500 uppercase tracking-widest">Registration Ends In</p>
                        <p id="timerDisplay" class="text-xl font-mono font-bold text-red-600">--:--:--:--</p>
                    </div>
                    <i class="fas fa-clock text-red-400 text-2xl"></i>
                </div>

                <div class="detail-section"><h4 class="text-lg font-bold dark:text-white mb-2">Eligibility</h4><p id="detEligibility" class="text-gray-600 dark:text-gray-400 text-sm font-medium"></p></div>
                <div class="detail-section"><h4 id="detFullTitle" class="text-lg font-bold dark:text-white mb-3 leading-tight"></h4><div class="relative"><p id="detDesc" class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed line-clamp-3 transition-all duration-300"></p><button id="readMoreBtn" onclick="toggleReadMore()" class="mt-2 text-primary-500 font-bold text-sm flex items-center gap-1 hover:underline">Read More <i class="fas fa-chevron-down text-[10px]"></i></button></div></div>
                <div class="detail-section">
                    <h4 class="text-lg font-bold dark:text-white mb-4">Registration Deadline</h4>
                    <div class="bg-gray-50 dark:bg-gray-900/50 rounded-2xl p-4 inline-flex items-center gap-4 border dark:border-gray-700">
                        <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl px-4 py-2 text-center min-w-[70px]"><span id="detDay" class="block text-2xl font-bold text-primary-600">--</span><span id="detMonth" class="block text-[10px] font-bold text-gray-400 uppercase">--</span></div>
                        <div><p id="detDeadlineFull" class="text-sm font-bold dark:text-white"></p><p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Last date to apply</p></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="leaderboardModal" class="fixed inset-0 z-[200] hidden flex items-center justify-center bg-black/60 backdrop-blur-md p-4">
        <div class="bg-white dark:bg-gray-800 w-full max-w-2xl rounded-[2.5rem] shadow-2xl overflow-hidden">
            <div class="p-8 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900/50">
                <div>
                    <h3 id="lbTitle" class="text-2xl font-bold dark:text-white">Leaderboard</h3>
                    <p id="lbDate" class="text-sm text-gray-500 font-medium"></p>
                </div>
                <button onclick="closeLeaderboard()" class="h-10 w-10 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center"><i class="fas fa-times text-gray-500"></i></button>
            </div>
            <div class="max-h-[60vh] overflow-y-auto no-scrollbar">
                <table class="w-full text-left border-collapse">
                    <thead class="sticky top-0 bg-gray-50 dark:bg-gray-800 shadow-sm z-10">
                        <tr class="text-[10px] uppercase font-bold text-gray-400 border-b dark:border-gray-700">
                            <th class="px-8 py-4">Rank</th>
                            <th class="px-8 py-4">Participant</th>
                            <th class="px-8 py-4">College</th>
                            <th class="px-8 py-4 text-right">Score</th>
                        </tr>
                    </thead>
                    <tbody id="lbBody" class="divide-y dark:divide-gray-700">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="profileOverlay" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black/50 backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-800 w-[320px] rounded-3xl overflow-hidden shadow-2xl transform transition-all">
            <div class="bg-[#1e4a7a] p-6 text-center relative h-32">
                <button onclick="toggleProfile()" class="absolute top-4 right-4 text-white/80 hover:text-white">
                    <i class="fas fa-times text-lg"></i>
                </button>
                <div class="absolute -bottom-10 left-1/2 -translate-x-1/2">
                    <div class="h-20 w-20 rounded-full border-4 border-white dark:border-gray-800 bg-[#1e4a7a] flex items-center justify-center text-white text-2xl font-bold">RK</div>
                </div>
            </div>
            <div class="pt-12 pb-6 px-6 text-center">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white">Raj Kumar</h3>
                <p class="text-xs text-gray-500 flex items-center justify-center gap-1"><i class="fas fa-university"></i> XYZ Institute Admin</p>
                <p class="text-xs text-gray-500 mb-3 flex items-center justify-center gap-1">ID: Faculty_001</p>

                <div class="flex justify-between border-y border-gray-100 dark:border-gray-700 py-4 mb-6">
                    <div><p class="text-[10px] font-bold text-primary-400 uppercase">Contest</p><p class="text-lg font-bold dark:text-white">124</p></div>
                    <div class="border-x border-gray-100 dark:border-gray-700 px-6"><p class="text-[10px] font-bold text-primary-400 uppercase">Requests</p><p class="text-lg font-bold dark:text-white">42</p></div>
                    <div><p class="text-[10px] font-bold text-primary-400 uppercase">Reports</p><p class="text-lg font-bold dark:text-white">1.2k</p></div>
                </div>
                <div class="space-y-1">
                    <button class="w-full flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors group">
                        <div class="flex items-center gap-3"><i class="fas fa-user-circle text-primary-400"></i><span class="text-sm font-medium text-gray-700 dark:text-gray-200">My Profile</span></div>
                        <i class="fas fa-chevron-right text-[10px] text-gray-400 group-hover:translate-x-1 transition-transform"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors group">
                        <div class="flex items-center gap-3"><i class="fas fa-question-circle text-primary-400"></i><span class="text-sm font-medium text-gray-700 dark:text-gray-200">Help & Support</span></div>
                        <i class="fas fa-chevron-right text-[10px] text-gray-400 group-hover:translate-x-1 transition-transform"></i>
                    </button>
                    <button id="logoutBtn" class="w-full flex items-center gap-3 p-3 rounded-xl hover:bg-red-50 dark:hover:bg-red-900/20 group mt-2 transition-all">
                        <div class="w-8 h-8 rounded-full bg-red-50 dark:bg-red-900/20 text-red-500 dark:text-red-400 flex items-center justify-center">
                            <i class="fas fa-sign-out-alt"></i>
                        </div>
                        <span class="text-sm font-medium text-red-600 dark:text-red-400">Log out</span>
                    </button>
                </div>
                <button onclick="toggleProfile()" class="mt-4 text-[10px] font-bold text-gray-400 uppercase hover:text-gray-600 transition-colors">Close</button>
            </div>
        </div>
    </div>

    <script>
        // --- Sidebar Toggle Logic ---
        const sidebar = document.getElementById('mainSidebar');
        const sidebarToggleBtn = document.getElementById('sidebarToggleBtn');
        const toggleIcon = sidebarToggleBtn.querySelector('i');

        sidebarToggleBtn.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');
            if (sidebar.classList.contains('collapsed')) {
                toggleIcon.classList.replace('fa-chevron-left', 'fa-chevron-right');
            } else {
                toggleIcon.classList.replace('fa-chevron-right', 'fa-chevron-left');
            }
        });

        // --- Notification Toggle Logic ---
        const notificationBtn = document.getElementById('notificationBtn');
        const notifDropdown = document.getElementById('notifDropdown');
        notificationBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            notifDropdown.classList.toggle('hidden');
        });

        // --- Global Click Listener (Close Dropdowns) ---
        document.addEventListener('click', (e) => {
            if (!notifDropdown.contains(e.target) && !notificationBtn.contains(e.target)) {
                notifDropdown.classList.add('hidden');
            }
            if (e.target === document.getElementById('profileOverlay')) {
                toggleProfile();
            }
        });

        // --- Existing Page Logic ---
        let currentLevel = 'college';
        let activeTab = 'upcoming';
        let timerInterval;
        let availableColleges = ["Global Tech University", "State Engineering College", "City Polytechnic", "IIT Madras", "BITS Pilani", "Delhi University"];
        
        let contests = [
            { id: 1, title: "Winter Code Sprint 2026", date: "2026-01-25", deadline: "2026-01-20", eligibility: "3rd Year Students", description: "Grand coding contest for enthusiasts across all departments. Participants will face 5 algorithmic challenges over 3 hours.", participants: 120, time: "3h", isInter: false, colleges: [], level: 'college' },
            { id: 2, title: "Inter-State Hackathon", date: "2026-02-10", deadline: "2026-02-05", eligibility: "Open for all students", description: "Multi-college hackathon hosted by our campus. Team up and build a solution for sustainable cities in 24 hours.", participants: 450, time: "24h", isInter: true, colleges: ["Global Tech University", "IIT Madras"], level: 'college' },
            { id: 3, title: "Autumn Algo-Challenge", date: "2025-11-15", deadline: "2025-11-10", eligibility: "1st & 2nd Year", description: "Foundational algorithm contest for juniors. Focused on sorting, searching, and basic recursion.", participants: 85, time: "2h", isInter: false, colleges: [], level: 'college' },
            { id: 4, title: "Bug Squash 2025", date: "2025-10-05", deadline: "2025-10-01", eligibility: "All branches", description: "Find the vulnerabilities and bugs in the provided codebase. Fastest bug hunters won cash prizes.", participants: 210, time: "1.5h", isInter: true, colleges: ["Delhi University"], level: 'college' },
            { id: 101, title: "Google Hash Code 2026", date: "2026-02-20", deadline: "2026-02-14", eligibility: "Everyone Globally", description: "Global team-based programming competition organized by Google. Solve real-life engineering problems.", participants: "150k+", time: "4h", isInter: false, level: 'global' },
            { id: 102, title: "Meta Hacker Cup", date: "2026-03-05", deadline: "2026-02-28", eligibility: "Global Participants", description: "Meta's annual global open programming competition. Multiple rounds testing advanced problem solving.", participants: "80k", time: "3h", isInter: false, level: 'global' },
            { id: 103, title: "ICPC Regional Finals 2025", date: "2025-12-10", deadline: "2025-11-30", eligibility: "Qualified Teams", description: "The most prestigious competitive programming competition in the world for college students.", participants: "12k", time: "5h", isInter: true, level: 'global' }
        ];

        const leaderboardData = {
            3: [{ rank: 1, name: "Rahul Kumar", college: "Internal", score: 980 }, { rank: 2, name: "Sneha Singh", college: "Internal", score: 945 }, { rank: 3, name: "Amit Patel", college: "Internal", score: 890 }],
            4: [{ rank: 1, name: "John Doe", college: "Delhi University", score: 1200 }, { rank: 2, name: "Rahul Kumar", college: "Our Campus", score: 1150 }, { rank: 3, name: "Priya Das", college: "Delhi University", score: 1100 }],
            103: [{ rank: 1, name: "Team Void", college: "IIT Delhi", score: "5/5" }, { rank: 2, name: "Team Binary", college: "BITS Pilani", score: "4/5" }, { rank: 3, name: "Team Logic", college: "Delhi University", score: "4/5" }]
        };

        function switchLevel(level) {
            currentLevel = level;
            document.getElementById('collegeLevelBtn').className = level === 'college' ? "px-6 py-2.5 rounded-xl font-bold bg-white dark:bg-gray-700 shadow-sm text-primary-500" : "px-6 py-2.5 rounded-xl font-bold text-gray-500";
            document.getElementById('globalLevelBtn').className = level === 'global' ? "px-6 py-2.5 rounded-xl font-bold bg-white dark:bg-gray-700 shadow-sm text-primary-500" : "px-6 py-2.5 rounded-xl font-bold text-gray-500";
            document.getElementById('pageHeading').innerText = level === 'college' ? "College Contests" : "Global Level Events";
            document.getElementById('createContestBtn').style.display = (level === 'college' && activeTab === 'upcoming') ? 'flex' : 'none';
            applyFilters();
        }

        function switchTab(tab) {
            activeTab = tab;
            document.getElementById('upcomingTab').className = `tab-btn pb-3 ${tab === 'upcoming' ? 'active' : 'text-gray-400'}`;
            document.getElementById('pastTab').className = `tab-btn pb-3 ${tab === 'past' ? 'active' : 'text-gray-400'}`;
            document.getElementById('createContestBtn').style.display = (currentLevel === 'college' && tab === 'upcoming') ? 'flex' : 'none';
            applyFilters();
        }

        function applyFilters() {
            const today = "2026-01-14";
            const filtered = contests.filter(c => {
                const isPast = c.date < today;
                return c.level === currentLevel && (activeTab === 'upcoming' ? !isPast : isPast);
            });
            renderContests(filtered);
        }

        function renderContests(data) {
            const container = document.getElementById('contestContainer');
            container.innerHTML = data.length ? '' : '<div class="text-center py-20 text-gray-400 italic">No records found.</div>';
            data.forEach(c => {
                const color = c.isInter ? 'purple' : 'primary';
                container.innerHTML += `
                    <div onclick="openDetailsModal(${c.id})" class="cursor-pointer bg-white dark:bg-gray-800 rounded-3xl p-7 border dark:border-gray-700 shadow-sm hover:shadow-lg transition-all border-l-8 border-l-${color === 'primary' ? 'primary-500' : 'purple-500'}">
                        <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                            <div class="flex-1 w-full">
                                <span class="bg-${color}-50 dark:bg-${color}-900/20 text-${color}-600 text-[10px] font-bold px-3 py-1 rounded-full uppercase inline-block mb-3">${c.isInter ? 'Multi-College' : 'Internal'}</span>
                                <h3 class="text-2xl font-bold dark:text-white mb-1">${c.title}</h3>
                                <div class="flex flex-wrap gap-4 mt-4 text-[10px] text-gray-400 font-bold uppercase tracking-widest">
                                    <span><i class="far fa-calendar text-primary-500 mr-2"></i>Date: ${c.date}</span>
                                    ${c.deadline ? `<span><i class="fas fa-hourglass-half text-red-500 mr-2"></i>Deadline: ${c.deadline}</span>` : ''}
                                    <span><i class="fas fa-users text-primary-500 mr-2"></i>${c.participants}</span>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                ${activeTab === 'upcoming' ? `
                                    <button onclick="event.stopPropagation(); openShareMenu(event)" class="p-3 bg-gray-100 dark:bg-gray-700 rounded-xl"><i class="fas fa-share-alt"></i></button>
                                    ${c.level === 'college' ? `<button onclick="event.stopPropagation(); openEditModal(${c.id})" class="bg-primary-600 text-white px-8 py-3 rounded-xl font-bold">Edit</button>` : ''}
                                ` : `<button onclick="event.stopPropagation(); openLeaderboard(${c.id})" class="bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold">View Results</button>`}
                            </div>
                        </div>
                    </div>`;
            });
        }

        function openLeaderboard(id) {
            const c = contests.find(x => x.id == id);
            const data = leaderboardData[id] || [];
            document.getElementById('lbTitle').innerText = c.title + " Leaderboard";
            document.getElementById('lbDate').innerText = "Conducted on " + c.date;
            const body = document.getElementById('lbBody');
            body.innerHTML = data.length ? data.map(p => `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors">
                    <td class="px-8 py-4"><span class="flex items-center justify-center w-8 h-8 rounded-full font-bold text-sm ${p.rank === 1 ? 'bg-yellow-100 text-yellow-600' : p.rank === 2 ? 'bg-gray-200 text-gray-600' : p.rank === 3 ? 'bg-orange-100 text-orange-600' : 'text-gray-400'}">${p.rank}</span></td>
                    <td class="px-8 py-4 font-bold dark:text-white">${p.name}</td>
                    <td class="px-8 py-4 text-gray-500 text-sm font-medium">${p.college}</td>
                    <td class="px-8 py-4 text-right font-mono font-bold text-primary-600">${p.score}</td>
                </tr>`).join('') : '<tr><td colspan="4" class="p-10 text-center text-gray-400 italic">Leaderboard data not finalized yet.</td></tr>';
            document.getElementById('leaderboardModal').classList.remove('hidden');
        }

        function closeLeaderboard() { document.getElementById('leaderboardModal').classList.add('hidden'); }
        function loadCollegeList() {
            const list = document.getElementById('collegeCheckboxList');
            const cId = document.getElementById('editId').value;
            const current = contests.find(x => x.id == cId);
            const selected = current ? current.colleges : [];
            list.innerHTML = availableColleges.map(c => `
                <label class="flex items-center gap-3 p-2 hover:bg-white dark:hover:bg-gray-800 rounded-lg cursor-pointer">
                    <input type="checkbox" value="${c}" ${selected.includes(c) ? 'checked' : ''} class="w-4 h-4 rounded text-purple-600">
                    <span class="text-sm dark:text-gray-300 font-medium">${c}</span>
                </label>`).join('');
            updateSelectAllBtnState();
        }
        function filterColleges() { const val = document.getElementById('collegeSearch').value.toLowerCase(); document.querySelectorAll('#collegeCheckboxList label').forEach(item => { item.style.display = item.innerText.toLowerCase().includes(val) ? 'flex' : 'none'; }); }
        function toggleSelectAll() { const boxes = document.querySelectorAll('#collegeCheckboxList input[type="checkbox"]'); const allChecked = Array.from(boxes).every(cb => cb.checked); boxes.forEach(cb => cb.checked = !allChecked); updateSelectAllBtnState(); }
        function updateSelectAllBtnState() { const btn = document.getElementById('selectAllBtn'); const boxes = document.querySelectorAll('#collegeCheckboxList input[type="checkbox"]'); if(boxes.length) btn.innerText = Array.from(boxes).every(cb => cb.checked) ? "Unselect All" : "Select All"; }
        function addNewCollege() { const v = document.getElementById('customCollegeInput').value.trim(); if (v && !availableColleges.includes(v)) { availableColleges.push(v); document.getElementById('customCollegeInput').value = ''; loadCollegeList(); } }
        function startCountdown(deadlineStr) {
            clearInterval(timerInterval);
            const deadline = new Date(deadlineStr + "T23:59:59").getTime();
            timerInterval = setInterval(() => {
                const now = new Date().getTime();
                const dist = deadline - now;
                if (dist < 0) { document.getElementById('timerDisplay').innerText = "REGISTRATION CLOSED"; clearInterval(timerInterval); return; }
                const d = Math.floor(dist / (1000 * 60 * 60 * 24));
                const h = Math.floor((dist % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((dist % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((dist % (1000 * 60)) / 1000);
                document.getElementById('timerDisplay').innerText = `${d}d : ${h}h : ${m}m : ${s}s`;
            }, 1000);
        }
        function openDetailsModal(id) {
            const c = contests.find(x => x.id == id); if (!c) return;
            document.getElementById('detEligibility').innerText = c.eligibility || "Open for all students";
            document.getElementById('detFullTitle').innerText = "About " + c.title;
            document.getElementById('detDesc').innerText = c.description;
            if (c.deadline) {
                const dObj = new Date(c.deadline);
                document.getElementById('detDay').innerText = dObj.getDate();
                document.getElementById('detMonth').innerText = dObj.toLocaleString('default', { month: 'short' });
                document.getElementById('detDeadlineFull').innerText = dObj.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });
                startCountdown(c.deadline);
            }
            document.getElementById('detailsModal').classList.remove('hidden');
        }
        function closeDetailsModal() { document.getElementById('detailsModal').classList.add('hidden'); clearInterval(timerInterval); }
        function toggleReadMore() {
            const desc = document.getElementById('detDesc'); const btn = document.getElementById('readMoreBtn'); desc.classList.toggle('line-clamp-3');
            btn.innerHTML = desc.classList.contains('line-clamp-3') ? 'Read More <i class="fas fa-chevron-down text-[10px]"></i>' : 'Read Less <i class="fas fa-chevron-up text-[10px]"></i>';
        }
        function openCreateModal() { document.getElementById('editId').value = ''; document.getElementById('newTitle').value = ''; document.getElementById('contestDate').value = ''; document.getElementById('contestDeadline').value = ''; document.getElementById('contestEligibility').value = ''; document.getElementById('contestDesc').value = ''; document.getElementById('deleteBtn').classList.add('hidden'); document.getElementById('createModal').classList.remove('hidden'); }
        function openEditModal(id) {
            const c = contests.find(x => x.id === id); if (!c) return;
            document.getElementById('editId').value = c.id; document.getElementById('newTitle').value = c.title; document.getElementById('contestDate').value = c.date; document.getElementById('contestDeadline').value = c.deadline; document.getElementById('contestEligibility').value = c.eligibility; document.getElementById('contestDesc').value = c.description; document.querySelector(`input[name="scope"][value="${c.isInter ? 'inter' : 'internal'}"]`).checked = true; toggleOpponentSelect(); document.getElementById('deleteBtn').classList.remove('hidden'); document.getElementById('createModal').classList.remove('hidden');
        }
        function closeCreateModal() { document.getElementById('createModal').classList.add('hidden'); }
        function saveContest() {
            const id = document.getElementById('editId').value; const title = document.getElementById('newTitle').value; const date = document.getElementById('contestDate').value;
            if (!title || !date) { alert("Title and Date are required!"); return; }
            const newContest = { id: id ? parseInt(id) : Date.now(), title: title, date: date, deadline: document.getElementById('contestDeadline').value, status: 'upcoming', level: currentLevel, isInter: document.querySelector('input[name="scope"]:checked').value === 'inter', eligibility: document.getElementById('contestEligibility').value, description: document.getElementById('contestDesc').value, participants: 0, time: document.getElementById('contestTime').value, colleges: [] };
            if (id) { contests[contests.findIndex(x => x.id == id)] = newContest; showToast("Contest updated successfully!"); } else { contests.push(newContest); showToast("Contest created successfully!"); }
            closeCreateModal(); applyFilters();
        }
        function deleteContest() { const id = document.getElementById('editId').value; contests = contests.filter(x => x.id != id); closeCreateModal(); applyFilters(); showToast("Deleted"); }
        function openShareMenu(e) { e.stopPropagation(); const m = document.getElementById('shareMenu'); m.style.top = `${e.pageY + 10}px`; m.style.left = `${e.pageX - 150}px`; m.classList.remove('hidden'); window.onclick = () => m.classList.add('hidden'); }
        function showToast(msg) { document.getElementById('toastMessage').innerText = msg; const t = document.getElementById('shareToast'); t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 2000); }
        function toggleOpponentSelect() { document.getElementById('opponentSection').classList.toggle('hidden', document.querySelector('input[name="scope"]:checked').value !== 'inter'); if (document.querySelector('input[name="scope"]:checked').value === 'inter') loadCollegeList(); }
        
        // Theme Toggle
        document.getElementById('themeToggleBtn').onclick = () => document.documentElement.classList.toggle('dark');
        
        // Initial Render
        applyFilters();

        // --- Profile Overlay Logic ---
        function toggleProfile() { document.getElementById('profileOverlay').classList.toggle('hidden'); }
        const logoutBtn = document.getElementById('logoutBtn'); 
        if (logoutBtn) { logoutBtn.addEventListener('click', () => { window.location.href = '../index.html'; }); }
    </script>
</body>
</html>