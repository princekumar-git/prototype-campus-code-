<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manage Contests - Faculty Dashboard</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ["Poppins", "sans-serif"] },
                    colors: {
                        primary: { 50: "#E7F0FA", 100: "#D0E1F5", 200: "#7BA4D0", 300: "#4D84C0", 400: "#2E5E99", 500: "#1E4A7A", 600: "#0D2440" },
                        dark: { bg: "#111827", card: "#1F2937", text: "#F9FAFB", border: "#374151" }
                    },
                },
            },
        };
    </script>
    <style>
        .sidebar::-webkit-scrollbar { width: 6px; }
        .sidebar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 3px; }
        .dark .sidebar::-webkit-scrollbar-thumb { background-color: #4b5563; }
        
        .sidebar.collapsed { width: 5rem; }
        .sidebar.collapsed span { display: none; }
        .sidebar.collapsed .nav-item { justify-content: center; padding-left: 0; padding-right: 0; }
        
        .nav-item.active { background-color: #E7F0FA; color: #1E4A7A; border-right: 4px solid #1E4A7A; }
        .dark .nav-item.active { background-color: #1F2937; color: #60A5FA; border-right: 4px solid #60A5FA; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn { animation: fadeIn 0.2s ease-out forwards; }
    </style>
</head>

<body class="bg-gray-50 dark:bg-gray-900 min-h-screen font-sans transition-colors duration-200 text-gray-800 dark:text-gray-200">
    <div class="flex h-screen overflow-hidden">
        
       <aside id="mainSidebar" class="sidebar w-64 bg-white dark:bg-gray-800 shadow-sm border-r border-gray-200 dark:border-gray-700 flex flex-col h-screen flex-shrink-0 transition-all duration-300 z-50">

    <div class="p-6 flex-shrink-0 flex items-center justify-between h-[88px]">
        <h1 class="text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2 overflow-hidden whitespace-nowrap">
            <i class="fas fa-code text-primary-500 text-2xl flex-shrink-0"></i>
            <span id="sidebarLogoText" class="transition-all duration-300 opacity-100">CampusCode</span>
        </h1>
        <button id="sidebarToggleBtn" class="p-1.5 rounded-lg text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-500 transition-colors focus:outline-none">
            <i class="fas fa-chevron-left transition-transform duration-300"></i>
        </button>
    </div>

    <nav class="flex-1 space-y-1 overflow-y-auto mt-2 font-sans">
        
        <a href="dashboard.html" class="group flex items-center gap-3 px-6 py-3.5 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-all border-r-4 border-transparent">
            <i class="fas fa-home w-5 text-center text-lg group-hover:scale-110 transition-transform"></i>
            <span class="whitespace-nowrap">Dashboard</span>
        </a>

        <a href="problem.html" class="group flex items-center gap-3 px-6 py-3.5 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-all border-r-4 border-transparent">
            <i class="fas fa-tasks w-5 text-center text-lg group-hover:scale-110 transition-transform"></i>
            <span class="whitespace-nowrap">Problems</span>
        </a>

        <a href="contest.html" class="group flex items-center gap-3 px-6 py-3.5 text-sm font-medium bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400 border-r-4 border-primary-600 dark:border-primary-400 transition-all">
            <i class="fas fa-trophy w-5 text-center text-lg"></i>
            <span class="whitespace-nowrap">Contests</span>
        </a>

        <a href="student.html" class="group flex items-center gap-3 px-6 py-3.5 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-all border-r-4 border-transparent">
            <i class="fas fa-users w-5 text-center text-lg group-hover:scale-110 transition-transform"></i>
            <span class="whitespace-nowrap">Students</span>
        </a>

        <a href="community.html" class="group flex items-center gap-3 px-6 py-3.5 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-all border-r-4 border-transparent">
            <i class="fas fa-comments w-5 text-center text-lg group-hover:scale-110 transition-transform"></i>
            <span class="whitespace-nowrap">Community</span>
        </a>

        <a href="report.html" class="group flex items-center gap-3 px-6 py-3.5 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-all border-r-4 border-transparent">
            <i class="fas fa-chart-pie w-5 text-center text-lg group-hover:scale-110 transition-transform"></i>
            <span class="whitespace-nowrap">Reports</span>
        </a>

    </nav>

    <div class="p-4 space-y-1 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex-shrink-0">
        
        <a href="help.html" class="group flex items-center gap-3 px-6 py-3.5 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-all rounded-lg">
            <i class="far fa-question-circle w-5 text-center text-lg group-hover:scale-110 transition-transform"></i>
            <span class="whitespace-nowrap">Help & Support</span>
        </a>

        <div id="settingsTrigger" class="group flex items-center gap-3 px-6 py-3.5 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-all rounded-lg cursor-pointer">
            <i class="fas fa-cog w-5 text-center text-lg group-hover:rotate-90 transition-transform duration-500"></i>
            <span class="whitespace-nowrap">Settings</span>
        </div>

    </div>
</aside>
        <div class="flex-1 overflow-y-auto">
            
            <header class="bg-white dark:bg-gray-800 shadow-sm transition-colors duration-200 sticky top-0 z-40">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
                    <div class="flex-1 max-w-2xl ml-4 flex items-center gap-4">
                        <h1 id="headerLogoText" class="text-xl font-bold text-gray-800 dark:text-white hidden transition-all duration-300 opacity-0 transform -translate-x-2 whitespace-nowrap">
                            CampusCode
                        </h1>
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white">Manage Contests</h2>
                    </div>

                    <div class="ml-4 flex items-center gap-3">
                        <button id="themeToggleBtn" class="p-2 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none transition-transform active:scale-95">
                            <i class="fas fa-moon text-xl"></i>
                        </button>
                        <div class="relative">
                            <button id="notificationBtn" class="p-2 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none">
                                <i class="fas fa-bell text-xl"></i>
                                <span class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500 border-2 border-white dark:border-gray-800"></span>
                            </button>
                        </div>
                        <button id="headerProfileBtn" class="ml-2 flex items-center gap-3 p-1 pr-3 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <div class="h-9 w-9 rounded-full bg-primary-500 flex items-center justify-center text-white font-bold text-sm">JD</div>
                            <span class="text-sm font-medium text-gray-700 dark:text-gray-200 hidden sm:block">Dr. John Doe</span>
                        </button>
                    </div>
                </div>
            </header>

            <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                
                <div id="section-manage-contests" class="content-section">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                        <div>
                            <h2 class="text-lg font-bold text-gray-800 dark:text-white">Contest Library</h2>
                            <p class="text-sm text-gray-500 dark:text-gray-400">View and manage all faculty contests.</p>
                        </div>
                        <button id="btn-create-contest" class="bg-primary-500 hover:bg-primary-600 text-white px-5 py-2.5 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center gap-2">
                            <i class="fas fa-plus"></i> Create Contest
                        </button>
                    </div>

                    <div class="border-b border-gray-200 dark:border-gray-700 mb-6">
                        <nav class="-mb-px flex space-x-8">
                            <button id="contest-tab-upcoming" class="active border-primary-500 text-primary-600 dark:text-primary-400 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors">
                                Upcoming & Active
                            </button>
                            <button id="contest-tab-past" class="border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors">
                                Past Contests
                            </button>
                        </nav>
                    </div>

                    <div id="contest-list-upcoming" class="space-y-4">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-5 flex flex-col md:flex-row items-start md:items-center justify-between gap-4 hover:shadow-md transition-shadow">
                            <div class="flex items-start gap-4">
                                <div class="w-12 h-12 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0 text-green-600 dark:text-green-400">
                                    <i class="fas fa-stopwatch text-xl"></i>
                                </div>
                                <div>
                                    <div class="flex items-center gap-2 mb-1">
                                        <h3 class="text-lg font-bold text-gray-900 dark:text-white contest-title">Weekly Coding Challenge #45</h3>
                                        <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400 animate-pulse">Active Now</span>
                                    </div>
                                    <div class="flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-gray-500 dark:text-gray-400">
                                        <span class="flex items-center gap-1"><i class="far fa-calendar-alt"></i> Oct 24, 2023</span>
                                        <span class="flex items-center gap-1"><i class="far fa-clock"></i> 2:00 PM - 5:00 PM</span>
                                        <span class="flex items-center gap-1"><i class="fas fa-users"></i> 156 Joined</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 w-full md:w-auto">
                                
                                <button 
            class="btn-view-details px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg text-sm font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
            data-title="Weekly Coding Challenge #45"
            data-eligibility="2nd & 3rd Year CSE Students"
            data-desc="This is a competitive programming contest designed to test your algorithms and data structures skills. Topics covered include Dynamic Programming, Graphs, and Greedy Algorithms."
            data-deadline="2026-10-24T14:00:00" 
        >
            <i class="far fa-eye"></i>
        </button>
                              
                                <button class="btn-edit-contest flex-1 md:flex-none px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                    Edit
                                </button>
                                <button class="btn-view-leaderboard flex-1 md:flex-none px-4 py-2 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400 rounded-lg text-sm font-medium hover:bg-primary-100 dark:hover:bg-primary-900/40 transition-colors">
                                    View Leaderboard
                                </button>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-5 flex flex-col md:flex-row items-start md:items-center justify-between gap-4 hover:shadow-md transition-shadow">
                            <div class="flex items-start gap-4">
                                <div class="w-12 h-12 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center flex-shrink-0 text-blue-600 dark:text-blue-400">
                                    <i class="fas fa-calendar-plus text-xl"></i>
                                </div>
                                <div>
                                    <div class="flex items-center gap-2 mb-1">
                                        <h3 class="text-lg font-bold text-gray-900 dark:text-white contest-title">Freshers Code Sprint</h3>
                                        <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400">Upcoming</span>
                                    </div>
                                    <div class="flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-gray-500 dark:text-gray-400">
                                        <span class="flex items-center gap-1"><i class="far fa-calendar-alt"></i> Nov 01, 2023</span>
                                        <span class="flex items-center gap-1"><i class="far fa-clock"></i> 10:00 AM - 1:00 PM</span>
                                        <span class="flex items-center gap-1"><i class="fas fa-users"></i> 42 Registered</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 w-full md:w-auto">
                                <button class="btn-edit-contest flex-1 md:flex-none px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                    Edit Details
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="contest-list-past" class="space-y-4 hidden">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-5 flex flex-col md:flex-row items-start md:items-center justify-between gap-4 opacity-75 hover:opacity-100 transition-opacity">
                            <div class="flex items-start gap-4">
                                <div class="w-12 h-12 rounded-lg bg-gray-100 dark:bg-gray-700 flex items-center justify-center flex-shrink-0 text-gray-500 dark:text-gray-400">
                                    <i class="fas fa-history text-xl"></i>
                                </div>
                                <div>
                                    <div class="flex items-center gap-2 mb-1">
                                        <h3 class="text-lg font-bold text-gray-900 dark:text-white contest-title">Weekly Coding Challenge #44</h3>
                                        <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">Ended</span>
                                    </div>
                                    <div class="flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-gray-500 dark:text-gray-400">
                                        <span class="flex items-center gap-1"><i class="far fa-calendar-check"></i> Oct 17, 2023</span>
                                        <span class="flex items-center gap-1"><i class="fas fa-users"></i> 134 Participants</span>
                                        <span class="flex items-center gap-1 text-green-600 dark:text-green-400"><i class="fas fa-trophy"></i> Winner: Alex Chen</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 w-full md:w-auto">
                                <button class="btn-view-results flex-1 md:flex-none px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                    <i class="fas fa-chart-bar mr-2"></i>Results
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="contest-form-view" class="hidden">
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 md:p-8">
                        <div class="flex items-center gap-4 mb-8">
                            <button id="btn-back-to-contest-list" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition-colors">
                                <i class="fas fa-arrow-left text-lg"></i>
                            </button>
                            <h2 id="form-title" class="text-2xl font-bold text-gray-800 dark:text-white">Create New Contest</h2>
                        </div>

                        <form id="create-contest-form" class="space-y-8">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4 border-b border-gray-100 dark:border-gray-700 pb-2">1. Basic Details</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Contest Title</label>
                                        <input type="text" id="form-contest-title" placeholder="e.g. End Semester Coding Assessment" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-4 py-2.5 text-sm text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Start Date & Time</label>
                                        <input type="datetime-local" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-4 py-2.5 text-sm text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">End Date & Time</label>
                                        <input type="datetime-local" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-4 py-2.5 text-sm text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 outline-none">
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4 border-b border-gray-100 dark:border-gray-700 pb-2">2. Add Problems</h3>
                                
                                <div class="bg-gray-50 dark:bg-gray-700/30 rounded-xl p-6 border border-dashed border-gray-300 dark:border-gray-600">
                                    <div class="flex flex-col md:flex-row gap-4 mb-4">
                                        <div class="flex-1">
                                            <select id="contest-problem-select" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-4 py-2.5 text-sm text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 outline-none">
                                                <option value="" disabled selected>Select a problem to add...</option>
                                                <option value="Binary Tree Inversion">Binary Tree Inversion (Medium)</option>
                                                <option value="Two Sum">Two Sum (Easy)</option>
                                                <option value="Merge K Sorted Lists">Merge K Sorted Lists (Hard)</option>
                                                <option value="Valid Parentheses">Valid Parentheses (Easy)</option>
                                                <option value="Maximum Subarray">Maximum Subarray (Medium)</option>
                                            </select>
                                        </div>
                                        <button type="button" id="btn-add-problem-to-contest" class="bg-primary-600 hover:bg-primary-700 text-white px-6 py-2.5 rounded-lg text-sm font-medium transition-colors">
                                            Add Problem
                                        </button>
                                    </div>

                                    <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
                                        <table class="w-full text-left">
                                            <thead class="bg-gray-50 dark:bg-gray-700 text-xs uppercase text-gray-500 dark:text-gray-400">
                                                <tr>
                                                    <th class="px-4 py-3">Problem Title</th>
                                                    <th class="px-4 py-3 text-right">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="added-problems-list" class="divide-y divide-gray-100 dark:divide-gray-700">
                                                <tr class="group border-b border-gray-100 dark:border-gray-700 last:border-0">
                                                    <td class="px-4 py-2 text-gray-800 dark:text-gray-200 text-sm">Example: Two Sum</td>
                                                    <td class="px-4 py-2 text-right">
                                                        <button type="button" class="text-gray-400 hover:text-red-500 transition-colors remove-contest-problem-btn">
                                                            <i class="fas fa-times"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4 border-b border-gray-100 dark:border-gray-700 pb-2">3. Rules & Description</h3>
                                <div id="editor-container" class="h-48 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"></div>
                            </div>

                            <div class="flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700">
                                <button type="button" id="btn-cancel-contest" class="px-6 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                    Cancel
                                </button>
                                <button type="submit" class="px-6 py-2.5 rounded-lg bg-primary-600 text-white font-medium hover:bg-primary-700 transition-colors shadow-sm shadow-primary-500/30">
                                    Save Contest
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

            </main>
        </div>
    </div>

    <div id="leaderboardModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm hidden">
        <div class="bg-white dark:bg-gray-800 w-full max-w-2xl rounded-xl shadow-2xl overflow-hidden animate-fadeIn m-4">
            <div class="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white">Leaderboard</h3>
                <button id="closeLeaderboardBtn" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-0 overflow-x-auto">
                <table class="w-full text-left">
                    <thead class="bg-gray-50 dark:bg-gray-700/50 text-gray-500 dark:text-gray-400 text-xs uppercase font-semibold">
                        <tr>
                            <th class="px-6 py-3">Rank</th>
                            <th class="px-6 py-3">Student Name</th>
                            <th class="px-6 py-3">Solved</th>
                            <th class="px-6 py-3 text-right">Score</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100 dark:divide-gray-700 text-sm">
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors">
                            <td class="px-6 py-4"><div class="w-6 h-6 rounded-full bg-yellow-100 text-yellow-700 flex items-center justify-center text-xs font-bold">1</div></td>
                            <td class="px-6 py-4 font-medium text-gray-900 dark:text-white">Alex Chen</td>
                            <td class="px-6 py-4 text-gray-600 dark:text-gray-300">5/5</td>
                            <td class="px-6 py-4 text-right font-bold text-primary-600 dark:text-primary-400">500</td>
                        </tr>
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors">
                            <td class="px-6 py-4"><div class="w-6 h-6 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center text-xs font-bold">2</div></td>
                            <td class="px-6 py-4 font-medium text-gray-900 dark:text-white">Sarah Johnson</td>
                            <td class="px-6 py-4 text-gray-600 dark:text-gray-300">4/5</td>
                            <td class="px-6 py-4 text-right font-bold text-primary-600 dark:text-primary-400">420</td>
                        </tr>
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors">
                            <td class="px-6 py-4"><div class="w-6 h-6 rounded-full bg-orange-100 text-orange-800 flex items-center justify-center text-xs font-bold">3</div></td>
                            <td class="px-6 py-4 font-medium text-gray-900 dark:text-white">Mike Ross</td>
                            <td class="px-6 py-4 text-gray-600 dark:text-gray-300">4/5</td>
                            <td class="px-6 py-4 text-right font-bold text-primary-600 dark:text-primary-400">380</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="p-4 bg-gray-50 dark:bg-gray-700/30 text-center border-t border-gray-200 dark:border-gray-700">
                <button class="text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 font-medium">View Full Leaderboard</button>
            </div>
        </div>
    </div>

    <div id="resultsModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm hidden">
        <div class="bg-white dark:bg-gray-800 w-full max-w-lg rounded-xl shadow-2xl overflow-hidden animate-fadeIn m-4">
            <div class="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white">Contest Results</h3>
                <button id="closeResultsBtn" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="p-4 bg-green-50 dark:bg-green-900/20 rounded-xl text-center">
                        <p class="text-xs text-green-600 dark:text-green-400 font-bold uppercase mb-1">Top Score</p>
                        <p class="text-2xl font-bold text-green-700 dark:text-green-300">100%</p>
                    </div>
                    <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl text-center">
                        <p class="text-xs text-blue-600 dark:text-blue-400 font-bold uppercase mb-1">Avg Score</p>
                        <p class="text-2xl font-bold text-blue-700 dark:text-blue-300">76%</p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span class="text-gray-600 dark:text-gray-400">Participation Rate</span>
                            <span class="font-bold text-gray-800 dark:text-white">85%</span>
                        </div>
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                            <div class="bg-primary-500 h-2 rounded-full" style="width: 85%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-trophy text-yellow-500 text-xl"></i>
                            <div>
                                <p class="text-sm font-bold text-gray-800 dark:text-white">Winner</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Alex Chen (CSE)</p>
                            </div>
                        </div>
                        <button class="text-primary-600 text-sm hover:underline">View Profile</button>
                    </div>
                </div>
            </div>
            <div class="p-4 bg-gray-50 dark:bg-gray-700/30 flex justify-end gap-3 border-t border-gray-200 dark:border-gray-700">
                <button id="btn-download-report" class="px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600">Download Report</button>
            </div>
        </div>
    </div>

     <div id="notificationDropdown" class="fixed top-16 right-6 z-[70] w-80 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-100 dark:border-gray-700 hidden animate-[fadeIn_0.1s_ease-out]">
        <div class="p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center">
            <h3 class="font-semibold text-gray-800 dark:text-white">Notifications</h3>
            <span class="text-xs text-primary-500 cursor-pointer hover:underline">Mark all read</span>
        </div>
        <div class="p-2">
            <div class="p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg cursor-pointer">
                <p class="text-sm text-gray-800 dark:text-gray-200 font-medium">System Update</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">Server maintenance scheduled for tonight.</p>
            </div>
             <div class="p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg cursor-pointer">
                <p class="text-sm text-gray-800 dark:text-gray-200 font-medium">New Student Enrollment</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">5 new students joined CS101.</p>
            </div>
        </div>
    </div>

    <div id="profileOverlay" class="fixed inset-0 z-[80] flex items-center justify-center bg-black/50 backdrop-blur-sm hidden">
        <div class="w-[380px] bg-white dark:bg-gray-800 rounded-3xl shadow-2xl overflow-hidden animate-[fadeIn_0.2s_ease-out]">
            <div class="bg-gradient-to-br from-[#1E4A7A] to-[#153255] relative pt-12 pb-20 px-6 text-center">
                <button id="closeProfileOverlay" class="absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 text-white/90 transition-all flex items-center justify-center backdrop-blur-sm">
                    <i class="fas fa-times text-sm"></i>
                </button>

                <div class="absolute left-1/2 bottom-[-48px] -translate-x-1/2">
                    <div class="relative w-24 h-24 rounded-full p-1.5 bg-white dark:bg-gray-800 ring-4 ring-[#1E4A7A]/10 dark:ring-[#1E4A7A]/30">
                        <div class="w-full h-full rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white text-3xl font-bold shadow-inner">
                            JD
                        </div>
                        <div class="absolute bottom-0 right-0 w-6 h-6 bg-green-500 border-4 border-white dark:border-gray-800 rounded-full"></div>
                    </div>
                </div>
            </div>

            <div class="pt-16 pb-8 px-6">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-1">Dr. John Doe</h2>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-3">Senior Professor & Researcher</p>

                    <div class="flex items-center justify-center gap-2 flex-wrap">
                        <span class="px-3 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 border border-blue-100 dark:border-blue-800">
                            CSE Dept
                        </span>
                        <span class="px-3 py-1 rounded-full text-xs font-semibold bg-purple-50 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 border border-purple-100 dark:border-purple-800">
                            Faculty
                        </span>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="p-3 rounded-2xl bg-gray-50 dark:bg-gray-700/30 border border-gray-100 dark:border-gray-700 text-center">
                         <p class="text-xs text-gray-500 uppercase font-semibold">Faculty ID</p>
                         <p class="text-sm font-bold text-gray-800 dark:text-gray-200">FAC-2023</p>
                    </div>
                    <div class="p-3 rounded-2xl bg-gray-50 dark:bg-gray-700/30 border border-gray-100 dark:border-gray-700 text-center">
                        <p class="text-xs text-gray-500 uppercase font-semibold">Joined</p>
                        <p class="text-sm font-bold text-gray-800 dark:text-gray-200">Aug 2015</p>
                   </div>
                </div>

                <div class="space-y-3">
                     <button id="logoutBtn" class="w-full flex items-center justify-between p-3 rounded-xl hover:bg-red-50 dark:hover:bg-red-900/20 group transition-all duration-200 border border-transparent hover:border-red-100 dark:hover:border-red-800">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 flex items-center justify-center">
                                <i class="fas fa-sign-out-alt text-sm"></i>
                            </div>
                            <span class="text-sm font-medium text-gray-700 dark:text-gray-200 group-hover:text-red-600 dark:group-hover:text-red-400">Logout</span>
                        </div>
                        <i class="fas fa-chevron-right text-xs text-gray-400 group-hover:text-red-500 dark:group-hover:text-red-400"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
   <div id="detailsModal" class="fixed inset-0 z-[200] hidden flex items-center justify-center bg-black/60 backdrop-blur-md p-4 transition-opacity duration-300">
    <div class="bg-white dark:bg-gray-800 w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden transform transition-all scale-95 opacity-0 duration-300 flex flex-col max-h-[90vh]" id="detailsModalContent">
        
        <div class="px-6 py-5 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-white dark:bg-gray-800 sticky top-0 z-10">
            <div class="flex items-center gap-3">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white">Contest Details</h3>
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400 border border-blue-100 dark:border-blue-800">
                    Student View
                </span>
            </div>
        </div>

        <div class="p-6 overflow-y-auto custom-scrollbar space-y-6">
            
            <div id="countdownBox" class="bg-gradient-to-r from-red-50 to-white dark:from-red-900/20 dark:to-gray-800 border border-red-100 dark:border-red-900/30 rounded-2xl p-5 flex items-center justify-between shadow-sm">
                <div>
                    <p class="text-xs font-bold text-red-500 uppercase tracking-widest mb-1 flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span> Registration Ends In
                    </p>
                    <p id="timerDisplay" class="text-2xl font-mono font-bold text-gray-800 dark:text-white tracking-tight">-- : -- : -- : --</p>
                </div>
                <div class="h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center text-red-500 dark:text-red-400">
                    <i class="fas fa-hourglass-half text-xl"></i>
                </div>
            </div>

            <div>
                <h4 id="detFullTitle" class="text-2xl font-bold text-gray-900 dark:text-white mb-3 leading-tight">Contest Title</h4>
                <div class="relative group">
                    <p id="detDesc" class="text-gray-600 dark:text-gray-300 text-sm leading-7 line-clamp-3 transition-all duration-300"></p>
                    <button id="readMoreBtn" class="mt-2 text-primary-600 dark:text-primary-400 font-semibold text-sm flex items-center gap-1 hover:underline">
                        Read More <i class="fas fa-chevron-down text-[10px]"></i>
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                
                <div class="p-4 rounded-2xl bg-gray-50 dark:bg-gray-700/30 border border-gray-100 dark:border-gray-700">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <h4 class="text-sm font-bold text-gray-900 dark:text-white">Eligibility</h4>
                    </div>
                    <p id="detEligibility" class="text-gray-600 dark:text-gray-400 text-sm pl-[52px]">All B.Tech Students</p>
                </div>

                <div class="p-4 rounded-2xl bg-gray-50 dark:bg-gray-700/30 border border-gray-100 dark:border-gray-700">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="p-2 rounded-lg bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400">
                            <i class="far fa-calendar-alt"></i>
                        </div>
                        <h4 class="text-sm font-bold text-gray-900 dark:text-white">Deadline</h4>
                    </div>
                    <div class="flex items-center gap-3 pl-[52px]">
                        <div class="text-center pr-3 border-r border-gray-200 dark:border-gray-600">
                            <span id="detDay" class="block text-lg font-bold text-gray-800 dark:text-white leading-none">--</span>
                            <span id="detMonth" class="text-[10px] font-bold text-gray-500 uppercase">--</span>
                        </div>
                        <div>
                            <p id="detDeadlineFull" class="text-xs font-medium text-gray-600 dark:text-gray-300"></p>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="p-5 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 flex justify-end gap-3">
            <button id="btn-modal-close" class="px-5 py-2.5 rounded-xl text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-700 hover:shadow-sm transition-all border border-transparent hover:border-gray-200 dark:hover:border-gray-600">
        Close Preview
    </button>
    
    <button id="btn-modal-edit" class="px-5 py-2.5 rounded-xl text-sm font-medium bg-primary-600 text-white hover:bg-primary-700 shadow-lg shadow-primary-500/30 transition-all flex items-center gap-2">
        <i class="fas fa-pen text-xs"></i> Edit Details
    </button>
        </div>

    </div>
</div>

    <div id="settingsMenu" class="hidden fixed bottom-16 left-4 w-72 bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-2xl rounded-2xl z-[9999] overflow-hidden transform transition-all duration-200 origin-bottom-left">
        <div class="p-2 space-y-1">
            <div class="px-3 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">Account</div>
            <a href="profile.html" class="flex items-center gap-3 px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl transition-colors cursor-pointer group">
                <i class="fas fa-user-circle w-5 text-gray-400 group-hover:text-primary-500 transition-colors"></i>
                Profile
            </a>
        </div>
        <div class="h-px bg-gray-100 dark:bg-gray-700 mx-4"></div>
        <div class="p-2 space-y-1">
            <div class="px-3 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">Preferences</div>
            <button id="themeAccordionBtn" class="w-full flex justify-between items-center px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl transition-colors cursor-pointer group focus:outline-none">
                <div class="flex items-center gap-3">
                    <i class="fas fa-palette w-5 text-gray-400 group-hover:text-primary-500 transition-colors"></i>
                    <span>Theme</span>
                </div>
                <i id="themeChevron" class="fas fa-chevron-right text-xs text-gray-400 transition-transform duration-200"></i>
            </button>
            <div id="themeOptionsContainer" class="hidden pl-4 pr-1 space-y-1 pb-1">
                <button data-value="light" class="theme-option w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                    <span class="flex items-center gap-2"><i class="fas fa-sun text-orange-400 w-4"></i> Light</span>
                    <i class="fas fa-check text-primary-500 opacity-0 check-icon"></i>
                </button>
                <button data-value="dark" class="theme-option w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                    <span class="flex items-center gap-2"><i class="fas fa-moon text-indigo-400 w-4"></i> Dark</span>
                    <i class="fas fa-check text-primary-500 opacity-0 check-icon"></i>
                </button>
                <button data-value="system" class="theme-option w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                    <span class="flex items-center gap-2"><i class="fas fa-desktop text-gray-400 w-4"></i> System</span>
                    <i class="fas fa-check text-primary-500 opacity-0 check-icon"></i>
                </button>
            </div>
        </div>
    </div>
    
    <script>
    document.addEventListener("DOMContentLoaded", function () {

        /* =========================================================================
           1. NAVIGATION & SIDEBAR
           ========================================================================= */
        const sidebar = document.getElementById('mainSidebar');
        const toggleBtn = document.getElementById('sidebarToggleBtn');
        const sidebarLogoText = document.getElementById('sidebarLogoText');
        const headerLogoText = document.getElementById('headerLogoText');
        const toggleIcon = toggleBtn ? toggleBtn.querySelector('i') : null;

        if (toggleBtn && sidebar) {
            toggleBtn.addEventListener('click', () => {
                sidebar.classList.toggle('collapsed');
                
                if (sidebar.classList.contains('collapsed')) {
                    sidebar.classList.replace('w-64', 'w-20');
                    if (toggleIcon) toggleIcon.style.transform = 'rotate(180deg)';
                    if (sidebarLogoText) {
                        sidebarLogoText.style.opacity = '0';
                        setTimeout(() => sidebarLogoText.style.display = 'none', 100); 
                    }
                    if (headerLogoText) {
                        headerLogoText.classList.remove('hidden');
                        setTimeout(() => headerLogoText.classList.remove('opacity-0', '-translate-x-2'), 50);
                    }
                } else {
                    sidebar.classList.replace('w-20', 'w-64');
                    if (toggleIcon) toggleIcon.style.transform = 'rotate(0deg)';
                    if (sidebarLogoText) {
                        sidebarLogoText.style.display = 'inline';
                        setTimeout(() => sidebarLogoText.style.opacity = '1', 50);
                    }
                    if (headerLogoText) {
                        headerLogoText.classList.add('opacity-0', '-translate-x-2');
                        setTimeout(() => headerLogoText.classList.add('hidden'), 300);
                    }
                }
            });
        }

        /* =========================================================================
           2. THEME TOGGLE (Main & Settings Menu)
           ========================================================================= */
        const themeBtn = document.getElementById('themeToggleBtn');
        const html = document.documentElement;
        const themeIcon = themeBtn ? themeBtn.querySelector('i') : null;

        // Function to set theme
        function setTheme(theme) {
            if (theme === 'dark') {
                html.classList.add('dark');
                localStorage.theme = 'dark';
                if (themeIcon) themeIcon.classList.replace('fa-moon', 'fa-sun');
            } else {
                html.classList.remove('dark');
                localStorage.theme = 'light';
                if (themeIcon) themeIcon.classList.replace('fa-sun', 'fa-moon');
            }
        }

        // Init Check
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            setTheme('dark');
        } else {
            setTheme('light');
        }

        // Topbar Toggle
        if (themeBtn) {
            themeBtn.addEventListener('click', () => {
                const isDark = html.classList.contains('dark');
                setTheme(isDark ? 'light' : 'dark');
            });
        }

        // Settings Menu Theme Options
        const themeOptions = document.querySelectorAll('.theme-option');
        themeOptions.forEach(option => {
            option.addEventListener('click', () => {
                const val = option.getAttribute('data-value');
                if(val === 'system') {
                    localStorage.removeItem('theme');
                    if (window.matchMedia('(prefers-color-scheme: dark)').matches) setTheme('dark');
                    else setTheme('light');
                } else {
                    setTheme(val);
                }
                
                // Update Check Icons
                document.querySelectorAll('.check-icon').forEach(icon => icon.classList.add('opacity-0'));
                option.querySelector('.check-icon').classList.remove('opacity-0');
            });
        });


        /* =========================================================================
           3. OVERLAYS (Notifications, Profile, Settings)
           ========================================================================= */
        
        // --- Notification ---
        const notifBtn = document.getElementById('notificationBtn');
        const notifDropdown = document.getElementById('notificationDropdown');
        if (notifBtn && notifDropdown) {
            notifBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                notifDropdown.classList.toggle('hidden');
            });
            document.addEventListener('click', (e) => {
                if (!notifDropdown.contains(e.target) && !notifBtn.contains(e.target)) notifDropdown.classList.add('hidden');
            });
        }

        // --- Profile Overlay ---
        const profileOverlay = document.getElementById("profileOverlay");
        const headerProfileBtn = document.getElementById("headerProfileBtn");
        const closeProfileBtn = document.getElementById("closeProfileOverlay");
        
        if (headerProfileBtn && profileOverlay) headerProfileBtn.addEventListener("click", () => profileOverlay.classList.remove("hidden"));
        if (closeProfileBtn && profileOverlay) closeProfileBtn.addEventListener("click", () => profileOverlay.classList.add("hidden"));
        if (profileOverlay) profileOverlay.addEventListener("click", (e) => { 
            if (e.target === profileOverlay) profileOverlay.classList.add("hidden"); 
        });

        // --- Settings Menu (FIXED) ---
        const settingsBtn = document.getElementById('settingsTrigger'); // Corrected ID
        const settingsPopup = document.getElementById('settingsMenu'); // Corrected ID
        
        if (settingsBtn && settingsPopup) {
            settingsBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                settingsPopup.classList.toggle('hidden');
            });
            document.addEventListener('click', (e) => {
                if (!settingsPopup.contains(e.target) && !settingsBtn.contains(e.target)) {
                    settingsPopup.classList.add('hidden');
                }
            });
        }

        // --- Settings Menu Accordion (Theme) ---
        const themeAccordionBtn = document.getElementById('themeAccordionBtn');
        const themeOptionsContainer = document.getElementById('themeOptionsContainer');
        const themeChevron = document.getElementById('themeChevron');

        if (themeAccordionBtn && themeOptionsContainer) {
            themeAccordionBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                themeOptionsContainer.classList.toggle('hidden');
                themeChevron.classList.toggle('rotate-90');
            });
        }

        // --- Logout ---
        const logoutBtn = document.getElementById('logoutBtn');
        if (logoutBtn) logoutBtn.addEventListener('click', () => window.location.href = 'index.html');


        /* =========================================================================
           4. CONTEST PAGE LOGIC
           ========================================================================= */
        
        // --- Tabs Logic ---
        const tabUpcoming = document.getElementById('contest-tab-upcoming');
        const tabPast = document.getElementById('contest-tab-past');
        const listUpcoming = document.getElementById('contest-list-upcoming');
        const listPast = document.getElementById('contest-list-past');

        if (tabUpcoming && tabPast) {
            tabUpcoming.addEventListener('click', () => {
                tabUpcoming.classList.add('border-primary-500', 'text-primary-600', 'dark:text-primary-400', 'active');
                tabUpcoming.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'dark:text-gray-400', 'dark:hover:text-gray-300');
                
                tabPast.classList.remove('border-primary-500', 'text-primary-600', 'dark:text-primary-400', 'active');
                tabPast.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'dark:text-gray-400', 'dark:hover:text-gray-300');
                
                listUpcoming.classList.remove('hidden');
                listPast.classList.add('hidden');
            });

            tabPast.addEventListener('click', () => {
                tabPast.classList.add('border-primary-500', 'text-primary-600', 'dark:text-primary-400', 'active');
                tabPast.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'dark:text-gray-400', 'dark:hover:text-gray-300');
                
                tabUpcoming.classList.remove('border-primary-500', 'text-primary-600', 'dark:text-primary-400', 'active');
                tabUpcoming.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'dark:text-gray-400', 'dark:hover:text-gray-300');

                listPast.classList.remove('hidden');
                listUpcoming.classList.add('hidden');
            });
        }

        // --- Create Contest View Toggle ---
        const btnCreate = document.getElementById('btn-create-contest');
        const btnBack = document.getElementById('btn-back-to-contest-list');
        const btnCancel = document.getElementById('btn-cancel-contest');
        
        const listView = document.getElementById('section-manage-contests');
        const formView = document.getElementById('contest-form-view');
        const formTitle = document.getElementById('form-title');
        const titleInput = document.getElementById('form-contest-title');

        if (btnCreate) {
            btnCreate.addEventListener('click', () => {
                listView.classList.add('hidden');
                formView.classList.remove('hidden');
                formTitle.textContent = "Create New Contest";
                titleInput.value = ""; 
            });
        }

        function closeForm() {
            formView.classList.add('hidden');
            listView.classList.remove('hidden');
        }

        if (btnBack) btnBack.addEventListener('click', closeForm);
        if (btnCancel) btnCancel.addEventListener('click', closeForm);

        // --- Edit Contest Logic ---
        const editBtns = document.querySelectorAll('.btn-edit-contest');
        editBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                listView.classList.add('hidden');
                formView.classList.remove('hidden');
                
                const card = btn.closest('.bg-white');
                const title = card ? card.querySelector('.contest-title').innerText : "Edit Contest";
                
                formTitle.textContent = "Edit Contest";
                titleInput.value = title; 
            });
        });

        // --- Add Problem to Contest Logic ---
        const btnAddProblem = document.getElementById('btn-add-problem-to-contest');
        const problemSelect = document.getElementById('contest-problem-select');
        const problemsTableBody = document.getElementById('added-problems-list');

        if (btnAddProblem && problemSelect && problemsTableBody) {
            btnAddProblem.addEventListener('click', () => {
                const selectedValue = problemSelect.value;
                if (selectedValue) {
                    const tr = document.createElement('tr');
                    tr.className = "group border-b border-gray-100 dark:border-gray-700 last:border-0 animate-fadeIn";
                    tr.innerHTML = `
                        <td class="px-4 py-2 text-gray-800 dark:text-gray-200 text-sm">${selectedValue}</td>
                        <td class="px-4 py-2 text-right">
                            <button type="button" class="text-gray-400 hover:text-red-500 transition-colors remove-contest-problem-btn">
                                <i class="fas fa-times"></i>
                            </button>
                        </td>
                    `;
                    problemsTableBody.appendChild(tr);
                    problemSelect.value = "";
                }
            });

            problemsTableBody.addEventListener('click', (e) => {
                const btn = e.target.closest('.remove-contest-problem-btn');
                if (btn) btn.closest('tr').remove();
            });
        }

        // --- Leaderboard Modal Logic ---
        const leaderboardModal = document.getElementById('leaderboardModal');
        const viewLeaderboardBtns = document.querySelectorAll('.btn-view-leaderboard');
        const closeLeaderboardBtn = document.getElementById('closeLeaderboardBtn');

        viewLeaderboardBtns.forEach(btn => {
            btn.addEventListener('click', () => leaderboardModal.classList.remove('hidden'));
        });

        if(closeLeaderboardBtn) closeLeaderboardBtn.addEventListener('click', () => leaderboardModal.classList.add('hidden'));
        if(leaderboardModal) leaderboardModal.addEventListener('click', (e) => { if(e.target === leaderboardModal) leaderboardModal.classList.add('hidden'); });

        // --- Results Modal Logic ---
        const resultsModal = document.getElementById('resultsModal');
        const viewResultsBtns = document.querySelectorAll('.btn-view-results');
        const closeResultsBtn = document.getElementById('closeResultsBtn');
        const btnDownloadReport = document.getElementById('btn-download-report');

        viewResultsBtns.forEach(btn => {
            btn.addEventListener('click', () => resultsModal.classList.remove('hidden'));
        });

        if(closeResultsBtn) closeResultsBtn.addEventListener('click', () => resultsModal.classList.add('hidden'));
        if(resultsModal) resultsModal.addEventListener('click', (e) => { if(e.target === resultsModal) resultsModal.classList.add('hidden'); });

        if(btnDownloadReport) {
            btnDownloadReport.addEventListener('click', () => {
                const content = `CONTEST REPORT\nGenerated by CampusCode`;
                const blob = new Blob([content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'contest_report.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            });
        }

        /* =========================================================================
           5. RICH TEXT EDITOR
           ========================================================================= */
        if (document.getElementById('editor-container')) {
            new Quill('#editor-container', {
                theme: 'snow',
                placeholder: 'Enter contest rules...',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered' }, { 'list': 'bullet' }],
                        [{ 'header': [1, 2, 3, false] }],
                        ['link', 'clean']
                    ]
                }
            });
        }

        /* =========================================================================
           6. CONTEST DETAILS MODAL (PREVIEW) & FOOTER ACTIONS
           ========================================================================= */
        const detailsModal = document.getElementById('detailsModal');
        const detailsContent = document.getElementById('detailsModalContent');
        const viewDetailBtns = document.querySelectorAll('.btn-view-details');
        const readMoreBtn = document.getElementById('readMoreBtn');
        const descText = document.getElementById('detDesc');
        const btnModalEdit = document.getElementById('btn-modal-edit');
        const btnModalClose = document.getElementById('btn-modal-close');
        let countdownInterval;

        // Open Modal
        window.openDetailsModal = function(btn) {
            const title = btn.getAttribute('data-title');
            const eligibility = btn.getAttribute('data-eligibility');
            const desc = btn.getAttribute('data-desc');
            const deadlineStr = btn.getAttribute('data-deadline'); 

            document.getElementById('detFullTitle').textContent = title;
            document.getElementById('detEligibility').textContent = eligibility;
            descText.textContent = desc;

            // Date Formatting
            const deadlineDate = new Date(deadlineStr);
            const day = deadlineDate.getDate();
            const month = deadlineDate.toLocaleString('default', { month: 'short' });
            const fullReadable = deadlineDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric', hour:'numeric', minute:'numeric' });

            document.getElementById('detDay').textContent = day < 10 ? '0'+day : day;
            document.getElementById('detMonth').textContent = month;
            document.getElementById('detDeadlineFull').textContent = fullReadable;

            // Start Timer
            startCountdown(deadlineDate);

            // Show Modal
            detailsModal.classList.remove('hidden');
            setTimeout(() => {
                detailsContent.classList.remove('scale-95', 'opacity-0');
                detailsContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        };

        // Close Modal
        window.closeDetailsModal = function() {
            detailsContent.classList.remove('scale-100', 'opacity-100');
            detailsContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                detailsModal.classList.add('hidden');
                clearInterval(countdownInterval);
            }, 300);
        };

        // Countdown Logic
        function startCountdown(endTime) {
            clearInterval(countdownInterval);
            function updateTimer() {
                const now = new Date().getTime();
                const distance = endTime - now;
                if (distance < 0) {
                    clearInterval(countdownInterval);
                    document.getElementById("timerDisplay").innerHTML = "REGISTRATION CLOSED";
                    return;
                }
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                document.getElementById("timerDisplay").innerHTML = `${days}d : ${hours}h : ${minutes}m : ${seconds}s`;
            }
            updateTimer();
            countdownInterval = setInterval(updateTimer, 1000);
        }

        // Attach Event Listeners to View Buttons
        viewDetailBtns.forEach(btn => {
            btn.addEventListener('click', () => openDetailsModal(btn));
        });

        // Modal Close Button
        if (btnModalClose) {
            btnModalClose.addEventListener('click', closeDetailsModal);
        }

        // Modal Edit Button (Redirect to Form)
        if (btnModalEdit) {
            btnModalEdit.addEventListener('click', () => {
                closeDetailsModal();
                listView.classList.add('hidden');
                formView.classList.remove('hidden');
                
                const modalTitle = document.getElementById('detFullTitle').textContent;
                formTitle.textContent = "Edit Contest";
                titleInput.value = modalTitle;
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        // Read More Toggle
        if (readMoreBtn) {
            readMoreBtn.addEventListener('click', () => {
                descText.classList.toggle('line-clamp-3');
                const isExpanded = !descText.classList.contains('line-clamp-3');
                readMoreBtn.innerHTML = isExpanded 
                    ? `Show Less <i class="fas fa-chevron-up text-[10px]"></i>`
                    : `Read More <i class="fas fa-chevron-down text-[10px]"></i>`;
            });
        }
    });
</script>
  
</body>
</html>